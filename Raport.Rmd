---
title: "Komputerowa analiza szeregów czasowych - raport 2"
author: "Szymon Malec 262276 , Tomasz Hałas 2546347"
output:
  pdf_document: 
    number_sections: true
    extra_dependencies: ["polski", "mathtools", "amsthm", "amssymb", "icomma", "upgreek", "xfrac", "scrextend", "float", "tabularx", "hyperref", "caption", "enumitem", "titlesec"]
fontsize: 12pt
---

\renewcommand{\figurename}{Wykres}
\renewcommand{\tablename}{Tablica}
\raggedbottom
\titlelabel{ \thetitle.\quad}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, eval = TRUE, fig.pos = "H", dev.args=list(encoding="CP1257.enc"))
```

```{r}
library(ggplot2)
library(dplyr)
library(knitr)


regression <- function(X, Y){
    r <- cor(X, Y, use="pairwise.complete.obs")
    Sx <- sd(X)
    Sy <- sd(Y)
    a <- r * Sy / Sx
    b <- mean(Y) - a * mean(X)
    return(c(a, b))
}
```




\section{Wstęp}

|       Celem niniejszej pracy jest wykorzystanie modelu ARMA do zbadania danych opisujących średnią temperaturę w Warszawie w latach. Skorzystaliśmy z danych dostępnych pod adresem \footnote{https://academic.udayton.edu/kissock/http/Weather/default.htm}, pochodzące z amerykańskiego National Climatic Data Center Strona zawiera pliki średnich temperatur dobowych dla 157 miast amerykańskich i 167 międzynarodowych. Pliki są aktualizowane na bieżąco i zawierają dane od 1 stycznia 1995 do chwili obecnej. Pogoda jest mierzona za pomcoą stopni Fahrenheita. Dane pogodowe dla miasta Warszawy znadują się na wykresie \ref{fig:danePogodowe}.

\begin{figure}[H]
  \includegraphics{images/raw_data.pdf}
    \caption{Wykresy temperatury dla miasta Warszawa}
  \centering
  \label{fig:danePogodowe}
\end{figure}

Na wykresie \ref{fig:danePogodowe} zauważalne są braki danych jakie występują w naszym zbiorze danych.

\section{Opis danych}

|       Ze względu na fakt, że posiadany przez nas zbiór danych jest bardzo obszerny oraz braku niektórych danych postanowiliśmy wziąść nasze dane do modelu z przedziału (PRZEDZIAŁ). Wykres temperatur dla miasta Warszawa w tym orkesie prezentuje się następująco \ref{fig:daneZakres}:


\begin{figure}[H]

  \includegraphics{images/range_data.pdf}
  \caption{Wykresy temperatury dla miasta Warszawa w latach >>>>>.}
  \centering
  \label{fig:daneZakres}
\end{figure}

Nasze dane opisujace pogode w mieście Warszawa charakteryzują się dużą występowanień okresowości. Położenie tego miasta w środowej europie sprawia, że występują w nim cztery poru roku co widać na wykresie \ref{fig:daneZakres}. Dodatkowo nasze dane występuje wariancją, która spowodawana jest zmiannami nagłymi zmiannami pogody. Na takich danych rozpoczeliśmy dalszą prace.


\section{Przygotowanie danych}

|       Na wykresie \label{fig:daneZakres} zauważyć można, że w danych występuje wyraźna okresowość. Nie jest to oczywiście zaskoczeniem, ponieważ dane opisują temperaturę, która w zimie przyjmuje mniejsze wartości niż w lecie. Z powodu występującej okresowości, stwierdzamy, że szereg z pewnością nie jest stacjonarny w słabym sensie, co potwierdzają także wykresy ACF i PACF (wykres \ref{raw_acf}). W szczególności wykres funcji autokorelacji, która bardzo powoli zbiega do zera, wskazuje na brak stacjonarności.

\begin{figure}[H]
		\centering
		\includegraphics[width=\columnwidth]{images/raw_acf.pdf}
		\caption{Wykresy funkcji autokorelacji (ACF) i autokorelacji cząstkowej (PACF) dla surowych danych w zależności od przesunięcia $h$.}
    \label{raw_acf}
\end{figure}

|       Oznaczmy badany szereg jako $X_t, \ t \in \{1, 2, \dots, 1893\}$. Aby uzyskać stacjonarność, skorzystamy z metody różnicowania. Definiujemy
$$
  \tilde{X}_t = X_{t+1} - X_t, \ t \in \{1, 2, \dots, 1892\}.
$$

\begin{figure}[H]
		\centering
		\includegraphics[width=350pt]{images/diff_temp.pdf}
		\caption{Dane po zastosowaniu metody różnicowania.}
    \label{diff_temp}
\end{figure}

\begin{figure}[H]
		\centering
		\includegraphics[width=\columnwidth]{images/diff_acf.pdf}
		\caption{Wykresy funkcji autokorelacji (ACF) i autokorelacji cząstkowej (PACF) dla danych po zastosowaniu metody różnicowania w zależności od przesunięcia $h$.}
    \label{diff_acf}
\end{figure}





\section{Dopasowanie modelu ARMA}




\section{Analiza szumu}

Analiza szumu w modelu ARMA polega na ocenie jakości modelu poprzez określenie stopnia, w jakim jego prognozy odpowiadają rzeczywistym danym. W ARMA, szum jest reprezentowany przez błąd prognozowania, który jest różnicą między prognozowanymi wartościami a rzeczywistymi wartościami. Aby ocenić jakość modelu, spojrzymy na:

\begin{itemize}
  \item założenie dot. średniej (wykres wartości resztowych)
  \item założenie dot. wariancji (wykres wartości resztowych)
  \item założenie dot. niezależności (wykres ACF/PACF dla wartości resztowych)
  \item założenie dot. normalności rozkładu (dystrybuanta / gęstość / test KS).
\end{itemize}

Zaczynając od wykresu wartości resztowych:
\begin{figure}[H]
		\centering
		\includegraphics[width=\columnwidth]{images/res_data.pdf}
		\caption{Wykres wartości resztowych}
    \label{rest_data}
\end{figure}

Widzimy, że na wykresie \ref{rest_data} nasze wartości oscylują wokół 0. Pojawia się tam też wariancja, ale jest ona miare umiarkowana. Nie występują na nim dość znaczące wartości odstające. Chcąc przebadać wariancje szumu wykonaliśmy wykres wariancji cząstkowej \ref{var_rest_data}. Wariancja cząstkowa to wartość średnia kwadratów różnicy między prognozowanymi wartościami a rzeczywistymi wartościami danych. Im mniejsza wariancja cząstkowa, tym lepsza jest prognoza modelu i tym mniejsze są błędy prognozowania.

\begin{figure}[H]
		\centering
		\includegraphics[width=\columnwidth]{images/res_data.pdf}
		\caption{wykres wariancji cząstkowej dla $k=200$}
    \label{var_rest_data}
\end{figure}


\section{Podsumowanie}

