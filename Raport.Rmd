---
title: "Komputerowa analiza szeregów czasowych - raport 2"
author: "Szymon Malec, Tomasz Hałas"
output:
  pdf_document: 
    number_sections: true
    extra_dependencies: ["polski", "mathtools", "amsthm", "amssymb", "icomma", "upgreek", "xfrac", "scrextend", "float", "tabularx", "hyperref", "caption", "enumitem", "titlesec"]
fontsize: 12pt
---

\renewcommand{\figurename}{Wykres}
\renewcommand{\tablename}{Tablica}
\raggedbottom
\titlelabel{ \thetitle.\quad}







\section{Wstęp}

|       Celem niniejszej pracy jest wykorzystanie modelu ARMA do zbadania danych opisujących średnią temperaturę w Warszawie w latach.



\section{Opis danych}




\section{Przygotowanie danych}

|       Na wykresie 1 zauważyć można, że w danych występuje wyraźna okresowość. Nie jest to oczywiście zaskoczeniem, ponieważ dane opisują temperaturę, która w zimie przyjmuje mniejsze wartości niż w lecie. Z powodu występującej okresowości, stwierdzamy, że szereg z pewnością nie jest stacjonarny w słabym sensie, co potwierdzają także wykresy ACF i PACF (wykres \ref{raw_acf}). W szczególności wykres funcji autokorelacji, która bardzo powoli zbiega do zera, wskazuje na brak stacjonarności.

\begin{figure}[H]
		\centering
		\includegraphics[width=\columnwidth]{images/raw_acf.pdf}
		\caption{Wykresy funkcji autokorelacji (ACF) i autokorelacji cząstkowej (PACF) dla surowych danych w zależności od przesunięcia $h$.}
    \label{raw_acf}
\end{figure}

|       Oznaczmy badany szereg jako $X_t, \ t \in \{1, 2, \dots, 1893\}$. Aby uzyskać stacjonarność, skorzystamy z metody różnicowania. Definiujemy nowy szereg
$$
  \tilde{X}_t = X_{t+1} - X_t, \ t \in \{1, 2, \dots, 1892\}.
$$
Na wykresie \ref{diff_temp} zobaczyć można, że szereg $\tilde{X}_t$ oscyluje wokół zera, a jego wariancja wydaje się być stabilna.

\begin{figure}[H]
		\centering
		\includegraphics[width=350pt]{images/diff_temp.pdf}
		\caption{Dane po zastosowaniu metody różnicowania.}
    \label{diff_temp}
\end{figure}

Dodatkowo wykresy ACF i PACF (wykres \ref{diff_acf}) nie dają podstaw, by przypuszczać że, szereg nie jest stacjonarny.

\begin{figure}[H]
		\centering
		\includegraphics[width=\columnwidth]{images/diff_acf.pdf}
		\caption{Wykresy funkcji autokorelacji (ACF) i autokorelacji cząstkowej (PACF) dla danych po zastosowaniu metody różnicowania w zależności od przesunięcia $h$.}
    \label{diff_acf}
\end{figure}





\section{Dopasowanie modelu ARMA}

|       Model
$$
  \tilde{X}_t - \varphi_1 \tilde{X}_{t-1} - ... - \varphi_p \tilde{X}_{t-p} = Z_t + \theta_1 Z_{t-1} + ... + \theta_q Z_{t-q},
$$
gdzie $\{Z_i\}_i \sim WN(0, \sigma^2)$ jest białym szumem.

\begin{figure}[H]
		\centering
		\includegraphics[width=\columnwidth]{images/conf_intervals.pdf}
		\caption{Wykresy ACF i PACF dla szeregu $\tilde{X}_t$ wraz z przedziałami ufności na poziomie ufności $1 - \alpha = 0.95$.}
    \label{conf_intervals}
\end{figure}






\section{Analiza szumu}




\section{Podsumowanie}

